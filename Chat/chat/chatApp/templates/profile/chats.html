{% load static %}
{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://kit.fontawesome.com/4606228898.js" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous" defer></script>
    <link rel="stylesheet" href="{% static 'css/chats.css' %}">
    <title>Document</title>
</head>
<body>
    
    
    {% include 'partials/sidebar.html' %}
    <div class="container">

            <div class="left-side">

                <div class="header">
                    
                    <div class="searching">
                        <input type="text" placeholder="Search..">
                    </div>
                    
                </div>

                <div class="main">
                    {% for friend in friends %}
                        <div class="friend">
                            <a href="{% url 'chat' friend.id %}">
                                <div class="content">
                                    <img src="{{friend.image.url}}" alt="">
                                    <div class="details">
                                        <span>{{friend.name}}</span>
                                        <p>{{last_msg}}</p>
                                    </div>
                                </div>

                                <div class="unread">
                                    <div class="unread-messages">
                                        
                                    </div>
                                </div>
                            </a>
                        </div>
                    {% endfor %}
                </div>
            </div>

            <div class="right-side">

            </div>

    </div>


    <script>
        setInterval(getNotification, 1000)
  
        function getNotification(){
            let url = "{% url 'chatNotification' %}"
    
            fetch(url)
            .then(res=>res.json())
            .then(data=>{
            console.log(data)
            let chatNotificationBtn = document.getElementsByClassName("unread-messages")
            for(let i = 0; i<data.length; i++){
                if (data[i] != 0) {
                    chatNotificationBtn[i].style.display = 'block';
                }
                // chatNotificationBtn[i].innerText = data[i]
            }
            })
            .catch(error => console.log(error))
        }

    </script>
</body>
</html>
{% endblock content%}
